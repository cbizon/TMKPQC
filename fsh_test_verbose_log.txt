============================= test session starts ==============================
platform darwin -- Python 3.9.23, pytest-8.4.1, pluggy-1.6.0 -- /opt/anaconda3/envs/TMKP2/bin/python
cachedir: .pytest_cache
rootdir: /Users/bizon/Projects/experiments/TMKP_QC_2
configfile: pytest.ini
plugins: cov-6.2.1, mock-3.14.1
collecting ... collected 26 items / 21 deselected / 5 selected

tests/test_stage1_normalization.py::test_stage1_fsh_edge_normalization === STAGE 1: Entity Collection & Normalization ===
--- STAGE 1 INPUT ---
edges_file: /var/folders/bw/t29qn9vx5ggdl604v2lzhzkc0000gp/T/tmpz1b87se5.jsonl
max_edges: 1
Collecting unique entities by streaming through edges...
Found 2 unique entities from 1 edges
Entity collection completed in 0.00 seconds
Normalizing entities...
Processing node normalization batch 1 of 1 (2 curies)
Entity normalization completed in 0.04 seconds
--- STAGE 1 OUTPUT ---
entities: ['GTOPDB:4386', 'UniProtKB:P80370']
normalized_data: {'GTOPDB:4386': {'id': {'identifier': 'GTOPDB:4386', 'label': 'FSH'}, 'equivalent_identifiers': [{'identifier': 'GTOPDB:4386', 'label': 'FSH'}], 'type': ['biolink:SmallMolecule', 'biolink:MolecularEntity', 'biolink:ChemicalEntity', 'biolink:PhysicalEssence', 'biolink:ChemicalOrDrugOrTreatment', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:ChemicalEntityOrProteinOrPolypeptide', 'biolink:NamedThing', 'biolink:PhysicalEssenceOrOccurrent']}, 'UniProtKB:P80370': {'id': {'identifier': 'NCBIGene:8788', 'label': 'DLK1'}, 'equivalent_identifiers': [{'identifier': 'NCBIGene:8788', 'label': 'DLK1'}, {'identifier': 'ENSEMBL:ENSG00000185559', 'label': 'DLK1 (Hsap)'}, {'identifier': 'HGNC:2907', 'label': 'DLK1'}, {'identifier': 'OMIM:176290'}, {'identifier': 'UMLS:C1414069', 'label': 'DLK1 gene'}, {'identifier': 'UniProtKB:A8K019', 'label': 'A8K019_HUMAN Protein delta homolog 1 (trembl)'}, {'identifier': 'UMLS:C0289979', 'label': 'DLK1 protein, human'}, {'identifier': 'MESH:C512941', 'label': 'DLK1 protein, human'}, {'identifier': 'UniProtKB:P80370', 'label': 'DLK1_HUMAN Protein delta homolog 1 (sprot)'}, {'identifier': 'PR:P80370', 'label': 'protein delta homolog 1 (human)'}, {'identifier': 'UMLS:C3274856', 'label': 'Protein Delta Homolog 1'}], 'type': ['biolink:Gene', 'biolink:GeneOrGeneProduct', 'biolink:GenomicEntity', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:PhysicalEssence', 'biolink:OntologyClass', 'biolink:BiologicalEntity', 'biolink:ThingWithTaxon', 'biolink:NamedThing', 'biolink:PhysicalEssenceOrOccurrent', 'biolink:MacromolecularMachineMixin', 'biolink:Protein', 'biolink:GeneProductMixin', 'biolink:Polypeptide', 'biolink:ChemicalEntityOrProteinOrPolypeptide'], 'information_content': 83.6}}
✅ Stage 1 normalization results:
   GTOPDB:4386 -> GTOPDB:4386 (FSH)
   UniProtKB:P80370 -> NCBIGene:8788 (DLK1)
PASSED
tests/test_stage2_synonyms.py::test_stage2_fsh_edge_synonyms === STAGE 2: Synonym Retrieval ===
--- STAGE 2 INPUT ---
Normalized data keys: ['GTOPDB:4386', 'UniProtKB:P80370']
  GTOPDB:4386 -> GTOPDB:4386
  UniProtKB:P80370 -> NCBIGene:8788
Getting synonyms...
Sending to synonym API: ['GTOPDB:4386', 'NCBIGene:8788']
Processing synonyms batch 1 of 1 (2 curies)
Synonym retrieval completed in 0.05 seconds
--- STAGE 2 OUTPUT ---
synonyms_data: {'GTOPDB:4386': {'curie': 'GTOPDB:4386', 'names': ['FSH', '4384', '4377'], 'names_exactish': ['FSH', '4384', '4377'], 'types': ['SmallMolecule', 'MolecularEntity', 'ChemicalEntity', 'PhysicalEssence', 'ChemicalOrDrugOrTreatment', 'ChemicalEntityOrGeneOrGeneProduct', 'ChemicalEntityOrProteinOrPolypeptide', 'NamedThing', 'Entity', 'PhysicalEssenceOrOccurrent'], 'preferred_name': 'FSH', 'shortest_name_length': 3, 'clique_identifier_count': 1, 'curie_suffix': 4386, 'id': '1b4b6841-c07b-49ca-b0a0-9f74733c8887', '_version_': 1842139199534268416}, 'NCBIGene:8788': {'curie': 'NCBIGene:8788', 'preferred_name': 'DLK1', 'names': ['DLK', 'pG2', 'ZOG', 'FA1', 'DLK1', 'PREF1', 'DLK-1', 'Delta1', 'Pref-1', 'DLK1 Gene', 'DLK1 gene', 'secredeltin', 'FETAL ANTIGEN 1', 'fetal antigen 1', 'delta-like 1 homolog', 'PREADIPOCYTE FACTOR 1', 'preadipocyte factor 1', 'protein delta homolog 1', 'delta-like homolog (Drosophila)', 'delta-like 1 homolog (Drosophila)', 'DELTA, DROSOPHILA, HOMOLOG-LIKE 1', 'DELTA-LIKE NONCANONICAL NOTCH LIGAND 1', 'Delta-Like 1 Homolog (Drosophila) Gene', 'delta like non-canonical Notch ligand 1', 'FA1 protein, human', 'DLK1 protein, human', 'Dll1 protein, human', 'PREF1 protein, human', 'Pref-1 protein, human', 'hDLK1-A protein, human', 'fetal antigen-1, human', 'fetal antigen 1, human', 'secredeltin protein, human', 'delta-like 1 protein, human', 'preadipocyte factor 1, human', 'pre-adipocyte factor 1, human', 'A8K019_HUMAN Protein delta homolog 1 (trembl)', 'delta-like 1 homolog (Drosophila) protein, human', 'hDLK1', 'pG2 (human)', 'DLK-1 (human)', 'Protein Delta Homolog 1', 'protein delta homolog 1 (human)', 'DLK1_HUMAN Protein delta homolog 1 (sprot)'], 'names_exactish': ['DLK', 'pG2', 'ZOG', 'FA1', 'DLK1', 'PREF1', 'DLK-1', 'Delta1', 'Pref-1', 'DLK1 Gene', 'DLK1 gene', 'secredeltin', 'FETAL ANTIGEN 1', 'fetal antigen 1', 'delta-like 1 homolog', 'PREADIPOCYTE FACTOR 1', 'preadipocyte factor 1', 'protein delta homolog 1', 'delta-like homolog (Drosophila)', 'delta-like 1 homolog (Drosophila)', 'DELTA, DROSOPHILA, HOMOLOG-LIKE 1', 'DELTA-LIKE NONCANONICAL NOTCH LIGAND 1', 'Delta-Like 1 Homolog (Drosophila) Gene', 'delta like non-canonical Notch ligand 1', 'FA1 protein, human', 'DLK1 protein, human', 'Dll1 protein, human', 'PREF1 protein, human', 'Pref-1 protein, human', 'hDLK1-A protein, human', 'fetal antigen-1, human', 'fetal antigen 1, human', 'secredeltin protein, human', 'delta-like 1 protein, human', 'preadipocyte factor 1, human', 'pre-adipocyte factor 1, human', 'A8K019_HUMAN Protein delta homolog 1 (trembl)', 'delta-like 1 homolog (Drosophila) protein, human', 'hDLK1', 'pG2 (human)', 'DLK-1 (human)', 'Protein Delta Homolog 1', 'protein delta homolog 1 (human)', 'DLK1_HUMAN Protein delta homolog 1 (sprot)'], 'types': ['Gene', 'GeneOrGeneProduct', 'GenomicEntity', 'ChemicalEntityOrGeneOrGeneProduct', 'PhysicalEssence', 'OntologyClass', 'BiologicalEntity', 'ThingWithTaxon', 'NamedThing', 'Entity', 'PhysicalEssenceOrOccurrent', 'MacromolecularMachineMixin', 'Protein', 'GeneProductMixin', 'Polypeptide', 'ChemicalEntityOrProteinOrPolypeptide'], 'shortest_name_length': 3, 'clique_identifier_count': 11, 'taxa': ['NCBITaxon:9606'], 'curie_suffix': 8788, 'id': '7de567ad-9d14-4421-adba-1b4854d0636a', '_version_': 1842245137310154752}}
Missing synonyms: ['Protein delta homolog 1', 'FA-1', 'DELTA1', 'Dlk1', 'Pref1', 'protein delta-like 1 homolog', 'Delta-like 1 homolog', 'protein delta-like 1', 'delta, drosophila, homolog 1', 'delta-like 1', 'Delta-like protein 1', 'pG2 delta drosophila homolog', 'preadipocyte factor-1', 'DLK-1 protein', 'Delta-like 1', 'pG2delta', 'Delta-like homolog 1', 'fetal antigen-1', 'PREADIPOCYTE FACTOR-1', 'Delta1 protein', 'pG2-delta', 'delta-like protein 1', 'preadipocyte factor 1 protein', 'pG2-Delta', 'Delta-like 1 protein', 'delta like 1', 'preadipocyte factor I', 'FA-I']
Actual synonyms found: ['DLK', 'pG2', 'ZOG', 'FA1', 'DLK1', 'PREF1', 'DLK-1', 'Delta1', 'Pref-1', 'DLK1 Gene', 'DLK1 gene', 'secredeltin', 'FETAL ANTIGEN 1', 'fetal antigen 1', 'delta-like 1 homolog', 'PREADIPOCYTE FACTOR 1', 'preadipocyte factor 1', 'protein delta homolog 1', 'delta-like homolog (Drosophila)', 'delta-like 1 homolog (Drosophila)', 'DELTA, DROSOPHILA, HOMOLOG-LIKE 1', 'DELTA-LIKE NONCANONICAL NOTCH LIGAND 1', 'Delta-Like 1 Homolog (Drosophila) Gene', 'delta like non-canonical Notch ligand 1', 'FA1 protein, human', 'DLK1 protein, human', 'Dll1 protein, human', 'PREF1 protein, human', 'Pref-1 protein, human', 'hDLK1-A protein, human', 'fetal antigen-1, human', 'fetal antigen 1, human', 'secredeltin protein, human', 'delta-like 1 protein, human', 'preadipocyte factor 1, human', 'pre-adipocyte factor 1, human', 'A8K019_HUMAN Protein delta homolog 1 (trembl)', 'delta-like 1 homolog (Drosophila) protein, human', 'hDLK1', 'pG2 (human)', 'DLK-1 (human)', 'Protein Delta Homolog 1', 'protein delta homolog 1 (human)', 'DLK1_HUMAN Protein delta homolog 1 (sprot)']
✅ Stage 2 synonym retrieval results:
   GTOPDB:4386 synonyms: ['FSH', '4384', '4377']...
   NCBIGene:8788 synonyms: ['DLK', 'pG2', 'ZOG', 'FA1', 'DLK1']...
PASSED
tests/test_stage3_exact.py::test_stage3_fsh_edge_exact_matches --- STAGE 3 INPUT ---
edge: {'subject': 'GTOPDB:4386', 'object': 'NCBIGene:8788', 'sentences': 'FSH stimulation increased DLK1 protein expression levels significantly.'}
synonyms_data: {'GTOPDB:4386': {'curie': 'GTOPDB:4386', 'preferred_name': 'FSH', 'names': ['FSH', '4384', '4377'], 'types': ['SmallMolecule']}, 'NCBIGene:8788': {'curie': 'NCBIGene:8788', 'preferred_name': 'DLK1', 'names': ['DLK1', 'FA1', 'PREF1', 'fetal antigen 1', 'protein delta homolog 1'], 'types': ['Gene']}}
=== STAGE 3: Text Matching & Lookup ===
Finding synonyms in supporting text...
Found 2 synonyms in text: ['DLK1', 'FSH']...
Performing reverse lookups for found synonyms...
Text matching and lookup completed in 0.12 seconds
--- STAGE 3 OUTPUT ---
lookup_cache: {'DLK1': [{'curie': 'NCBIGene:8788', 'label': 'DLK1', 'highlighting': {}, 'synonyms': ['DLK', 'pG2', 'ZOG', 'FA1', 'DLK1', 'PREF1', 'DLK-1', 'Delta1', 'Pref-1', 'DLK1 Gene', 'DLK1 gene', 'secredeltin', 'FETAL ANTIGEN 1', 'fetal antigen 1', 'delta-like 1 homolog', 'PREADIPOCYTE FACTOR 1', 'preadipocyte factor 1', 'protein delta homolog 1', 'delta-like homolog (Drosophila)', 'delta-like 1 homolog (Drosophila)', 'DELTA, DROSOPHILA, HOMOLOG-LIKE 1', 'DELTA-LIKE NONCANONICAL NOTCH LIGAND 1', 'Delta-Like 1 Homolog (Drosophila) Gene', 'delta like non-canonical Notch ligand 1', 'FA1 protein, human', 'DLK1 protein, human', 'Dll1 protein, human', 'PREF1 protein, human', 'Pref-1 protein, human', 'hDLK1-A protein, human', 'fetal antigen-1, human', 'fetal antigen 1, human', 'secredeltin protein, human', 'delta-like 1 protein, human', 'preadipocyte factor 1, human', 'pre-adipocyte factor 1, human', 'A8K019_HUMAN Protein delta homolog 1 (trembl)', 'delta-like 1 homolog (Drosophila) protein, human', 'hDLK1', 'pG2 (human)', 'DLK-1 (human)', 'Protein Delta Homolog 1', 'protein delta homolog 1 (human)', 'DLK1_HUMAN Protein delta homolog 1 (sprot)'], 'taxa': ['NCBITaxon:9606'], 'types': ['biolink:Gene', 'biolink:GeneOrGeneProduct', 'biolink:GenomicEntity', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:PhysicalEssence', 'biolink:OntologyClass', 'biolink:BiologicalEntity', 'biolink:ThingWithTaxon', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent', 'biolink:MacromolecularMachineMixin', 'biolink:Protein', 'biolink:GeneProductMixin', 'biolink:Polypeptide', 'biolink:ChemicalEntityOrProteinOrPolypeptide'], 'score': 3335.8547, 'clique_identifier_count': 11}], 'FSH': [{'curie': 'GTOPDB:4386', 'label': 'FSH', 'highlighting': {}, 'synonyms': ['FSH', '4384', '4377'], 'taxa': [], 'types': ['biolink:SmallMolecule', 'biolink:MolecularEntity', 'biolink:ChemicalEntity', 'biolink:PhysicalEssence', 'biolink:ChemicalOrDrugOrTreatment', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:ChemicalEntityOrProteinOrPolypeptide', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent'], 'score': 1296.6653, 'clique_identifier_count': 1}, {'curie': 'GTOPDB:4387', 'label': 'FSH', 'highlighting': {}, 'synonyms': ['FSH', '4385', '4378'], 'taxa': [], 'types': ['biolink:SmallMolecule', 'biolink:MolecularEntity', 'biolink:ChemicalEntity', 'biolink:PhysicalEssence', 'biolink:ChemicalOrDrugOrTreatment', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:ChemicalEntityOrProteinOrPolypeptide', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent'], 'score': 1296.6653, 'clique_identifier_count': 1}, {'curie': 'CHEBI:81569', 'label': 'Follitropin', 'highlighting': {}, 'synonyms': ['FSH', '3731', '3733', 'fshs', 'FSH-a', 'FSH-b', 'Bravelle', 'Fertinex', 'Metrodin', 'FSH-beta', 'Follitrin', 'FSH alpha', 'rFSH-alpha', 'Follitropin', 'FOLLITROPIN', 'follitropin', 'Metrodin HP', 'MENOTROPINS', 'Neo fertinorm', 'UROFOLLITROPIN', 'Urofollitropin', 'FSH preparation', 'Urofollitrophin', 'Folitropina beta', 'Follitropin alfa', 'FOLLITROPIN ALFA', 'Follitropin beta', 'Folitropina alfa', 'Follitrophin beta', 'Urinary human FSH', 'Follitropin gamma', 'Follitrophin alfa', 'Follitropin human', 'Folitropina delta', 'Follitropin delta', 'Follitropin alpha', 'follitropin delta', 'follitropin (FSH)', 'Follitrophin alpha', 'Human FSH, urinary', 'Metrodin high purity', 'Follitropin alfa/beta', 'High purity, metrodin', 'FSH-Follicle stim horm', 'Follotropin recombinant', 'Follicle-stimulating hormone', 'follicle-stimulating hormone', 'follicle hormone stimulating', 'FOLLICLE STIMULATING HORMONE', 'Follicle-Stimulating Hormone', 'follicle stimulating hormone', 'Follicle stimulating hormone', 'Follicle Stimulating Hormone', 'follicle hormones stimulating', 'Follicular stimulating hormone', 'follicular stimulating hormone', 'follicular hormones stimulating', 'follicle stimulating fsh hormone', 'FSH - Follicle stimulating hormone', 'FSH (Follicle Stimulating Hormone)', 'Follicle Stimulating Hormone, Human', 'Pituitary follicle stimulating hormone', 'Follicle stimulating hormone preparation', 'Follicle stimulating hormone (FSH), pituitary', 'Pituitary follicle stimulating hormone (substance)', 'Recombinant human follicle stimulating hormone beta', 'Recombinant human follicle-stimulating hormone (r-HFSH)', 'Pituitary follicle stimulating hormone-containing product', 'Product containing pituitary follicle stimulating hormone (medicinal product)', '2-[({1-[19-amino-13-(butan-2-yl)-6,9,12,15,18-pentahydroxy-7-[(C-hydroxycarbonimidoyl)methyl]-10-(1-hydroxyethyl)-16-[(4-hydroxyphenyl)methyl]-1,2-dithia-5,8,11,14,17-pentaazacycloicosa-5,8,11,14,17-pentaene-4-carbonyl]pyrrolidin-2-yl}(hydroxy)methylidene)amino]-N-[(C-hydroxycarbonimidoyl)methyl]-4-methylpentanimidate', 'Gonal F', 'GONAL-F', 'gonal f', 'gonal-f', 'f gonal', 'Gonal-F', 'follitropin alfa 37.5 UNT/ML Injectable Solution', 'Follitropin alfa 37.5 unit/mL solution for injection', 'Product containing precisely follitropin alfa 37.5 unit/1 milliliter conventional release solution for injection (clinical drug)', 'GONAL-F RFF KIT', 'Gonal F 75 UNT Injection', 'Gonal-F 75iu inj pdr+diluent', 'GONAL-f RFF 75 UNT Injection', 'Gonal-f RFF 75unit Powder for Injection', 'follitropin alfa 75 UNT Injection [Gonal F]', 'Gonal-F 75iu injection (pdr for recon)+diluent', 'Follitropin Alfa 75 IU Subcutaneous Powder for Solution [GONAL-F]', 'Gonal-f RFF, alpha 75 intl units subcutaneous powder for injection', 'Follitropin Alfa 75 IU Subcutaneous Powder for Solution [GONAL-F RFF]', 'FOLLITROPIN 75 [iU] in 1 mL SUBCUTANEOUS INJECTION, POWDER, LYOPHILIZED, FOR SOLUTION [GONAL-F RFF]', 'Follitropin alpha 150iu inj', 'Recom human FSH alph 150iu inj', 'follitropin alfa 300 UNT/ML Injectable Solution', 'Follitropin alpha 150iu injection powder+diluent', 'Follitropin alfa 300 unit/mL solution for injection', 'Recomb human follicle stim horm alpha 150iu inj pdr+diluent', 'follicle stimulating hormone alpha 300 intl units subcutaneous solution', 'Recombinant human follicle stimulating hormone alpha 150iu injection (pdr for recon)+diluent', 'Product containing precisely follitropin alfa 300 unit/1 milliliter conventional release solution for injection (clinical drug)', 'Urofollitrophin 75iu inj+solv', 'urofollitropin 150 UNT/ML Injectable Solution', 'Urofollitropin 150 unit/mL solution for injection', 'Urofollitrophin 75iu injection (pdr for recon)+solvent', 'Product containing precisely urofollitropin 150 unit/1 milliliter conventional release solution for injection (clinical drug)', 'follicle stimulating hormone 150 UNT/ML', 'urofollitropin 150 UNT/ML', 'FOLLITROPIN ALFA 450 UNIT/VIL INJ', 'FOLLITROPIN ALFA 1050 UNIT/VIL INJ', 'follitropin alfa 600 UNT/ML Injectable Solution', 'Follitropin alfa 600 unit/mL solution for injection', 'Follitropin Alfa 900 IU/1.5 ML Subcutaneous Solution', 'Follitropin Alfa 450 IU/0.75 ML Subcutaneous Solution', 'follitropin alfa, recombinant 450 unit SUBCUT VIAL (EA)', 'follitropin alfa, recombinant@450 unit@SUBCUT@VIAL (EA)', 'follitropin alfa, recombinant@1,050 unit@SUBCUT@VIAL (EA)', 'follitropin alfa, recombinant 1,050 unit SUBCUT VIAL (EA)', 'follicle stimulating hormone alpha 900 intl units subcutaneous solution', 'follicle stimulating hormone alpha 450 intl units subcutaneous powder for injection', 'Product containing precisely follitropin alfa 600 unit/1 milliliter conventional release solution for injection (clinical drug)', 'Gonal-f KIT', 'Gonal-f 450unit Powder for Injection', 'Gonal-f 1050unit Powder for Injection', 'GONAL-f 600 UNT/ML Injectable Solution', 'Gonal F 600 UNT/ML Injectable Solution', 'follitropin alfa 600 UNT/ML Injectable Solution [Gonal F]', 'Gonal-F, 1050 intl units subcutaneous powder for injection', 'Gonal-F, alpha 450 intl units subcutaneous powder for injection', 'Follitropin Alfa 450 IU Subcutaneous Powder for Solution [GONAL-F]', 'Follitropin Alfa 1050 IU Subcutaneous Powder for Solution [GONAL-F]', 'FOLLITROPIN 450 [iU] in 1 mL SUBCUTANEOUS INJECTION, POWDER, LYOPHILIZED, FOR SOLUTION [Gonal-f]', 'FOLLITROPIN 1050 [iU] in 2 mL SUBCUTANEOUS INJECTION, POWDER, LYOPHILIZED, FOR SOLUTION [Gonal-f]', 'follitropin alfa Injectable Solution [Gonal F]', 'urofollitropin Injectable Solution', 'follitropin beta 150 UNT in 0.5 ML Injection', '0.5 ML follitropin beta 300 UNT/ML Injection', 'follitropin beta 150 UNT per 0.5 ML Injection', 'follicle stimulating hormone beta 300 intl units subcutaneous solution', 'follitropin beta 300 UNT/ML', 'follitropin beta 833 UNT/ML', 'follitropin alfa 37.5 UNT/ML', 'follitropin alfa 300 UNT/ML', 'follitropin alfa 600 UNT/ML', 'follitropin alfa Injectable Solution', 'follitropin beta 833 UNT/ML [Follistim]', 'Follitropin alpha 75iu inj', 'FOLLITROPIN ALFA 75UNT/VIL INJ', 'Recom human FSH alpha 75iu inj', 'follitropin alfa 75 UNT Injection', 'Follitropin alpha 75iu injection powder+diluent', 'follitropin alfa, recombinant 75 unit SUBCUT VIAL (EA)', 'follitropin alfa, recombinant@75 unit@SUBCUT@VIAL (EA)', 'Follitropin Alfa 75 IU Subcutaneous Powder for Solution', 'follitropin alfa, recombinant@75 unit@SUBCUT@AMPUL (EA)', 'follitropin alfa, recombinant 75 unit SUBCUT AMPUL (EA)', 'Recomb human follicle stim horm alpha 75iu inj pdr+diluent', 'Follitropin alfa 75 unit powder for solution for injection vial', 'follicle stimulating hormone alpha 75 intl units subcutaneous powder for injection', 'Recombinant human follicle stimulating hormone alpha 75iu injection (pdr for recon)+diluent', 'Product containing precisely follitropin alfa 75 unit/1 vial powder for conventional release solution for injection (clinical drug)', 'follitropin alfa 600 UNT/ML [Gonal F]', 'FOLLITROPIN BETA 300UNIT/0.36ML INJ', '0.36 ML follitropin beta 833 UNT/ML Cartridge', 'follitropin beta 300 UNT in 0.36 ML Cartridge', 'follitropin beta 300 IU per 0.36 ML Cartridge', 'follitropin beta,recomb 300 unit/0.36 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant 300 unit/0.36 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant@300 unit/0.36 mL@SUBCUT@CARTRIDGE (ML)', 'FOLLITROPIN BETA 600UNIT/0.72ML INJ', 'follitropin beta 600 IU per 0.72 ML Cartridge', '0.72 ML follitropin beta 833 UNT/ML Cartridge', 'follitropin beta 600 UNT in 0.72 ML Cartridge', 'follicle stimulating hormone beta 600 intl units subcutaneous solution', 'follitropin beta,recomb 600 unit/0.72 mL deliverable (833 unit/mL) SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant@600 unit/0.72 mL deliverable (833 unit/mL)@SUBCUT@CARTRIDGE (ML)', 'follitropin beta,recombinant 600 unit/0.72 mL deliverable (833 unit/mL) SUBCUT CARTRIDGE (ML)', 'FOLLITROPIN BETA 900UNIT/1.08ML INJ', '1.08 ML follitropin beta 833 UNT/ML Cartridge', 'follitropin beta 900 UNT in 1.08 ML Cartridge', 'follitropin beta 900 IU per 1.08 ML Cartridge', 'follitropin beta 900 UNT per 1.08 ML Cartridge', 'follitropin beta,recomb 900 unit/1.08 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant 900 unit/1.08 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant@900 unit/1.08 mL@SUBCUT@CARTRIDGE (ML)', 'follicle stimulating hormone beta 900 intl units subcutaneous solution', 'follicle stimulating hormone 52.5 UNT/ML', 'follicle stimulating hormone 35 UNT/ML', 'urofollitropin Injectable Product', 'Urofollitropin-containing product in parenteral dose form', 'Product containing urofollitropin in parenteral dose form (medicinal product form)', 'follitropin alfa Injectable Product', 'Follitropin alfa-containing product in parenteral dose form', 'Product containing follitropin alfa in parenteral dose form (medicinal product form)', 'follitropin beta Injectable Product', 'Gonal F Injectable Product', 'Follistim Injectable Product', '0.36 ML Follistim 833 UNT/ML Cartridge', 'Follistim AQ 300 IU per 0.36 ML Cartridge', 'Follistim AQ 300 UNT in 0.36 ML Cartridge', 'Follistim AQ 300units Cartridge Solution for Injection', '0.36 ML follitropin beta 833 UNT/ML Cartridge [Follistim]', 'Follistim AQ Cartridge, beta 300 intl units subcutaneous solution', 'Follitropin Beta 300 IU/0.36 ML Subcutaneous Solution [FOLLISTIM AQ]', 'follitropin 300 [iU] in 0.36 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', 'follitropin 350 [iU] in 0.42 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', '0.72 ML Follistim 833 UNT/ML Cartridge', 'Follistim AQ 600 UNT in 0.72 ML Cartridge', 'Follistim AQ 600 IU per 0.72 ML Cartridge', 'Follistim AQ 600units Cartridge Solution for Injection', '0.72 ML follitropin beta 833 UNT/ML Cartridge [Follistim]', 'Follistim AQ Cartridge, beta 600 intl units subcutaneous solution', 'Follitropin Beta 600 IU/0.72 ML Subcutaneous Solution [FOLLISTIM AQ]', 'follitropin 650 [iU] in 0.78 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', 'follitropin 600 [iU] in 0.72 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', '1.08 ML Follistim 833 UNT/ML Cartridge', 'Follistim AQ 900 UNT in 1.08 ML Cartridge', 'Follistim AQ 900 IU per 1.08 ML Cartridge', 'Follistim AQ 900units Cartridge Solution for Injection', '1.08 ML follitropin beta 833 UNT/ML Cartridge [Follistim]', 'Follistim AQ Cartridge, beta 900 intl units subcutaneous solution', 'Follitropin Beta 900 IU/1.08 ML Subcutaneous Solution [FOLLISTIM AQ]', 'follitropin 975 [iU] in 1.17 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', 'follitropin 900 [iU] in 1.08 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', '1.5 ML Gonal F 600 UNT/ML Pen Injector', 'GONAL-f RFF Pen 900 UNT in 1.5 ML Pen Injector', 'Gonal F RFF Pen 900 UNT per 1.5 ML Pen Injector', 'Gonal F RFF Redi-ject 900 UNT per 1.5 ML Pen Injector', '1.5 ML follitropin alfa 600 UNT/ML Pen Injector [Gonal F]', 'Gonal-f RFF Pen, alpha 900 intl units subcutaneous solution', 'Gonal-f RFF Redi-ject Pen 900unit/1.5ml Solution for Injection', 'Follitropin Alfa 900 IU/1.5 ML Subcutaneous Solution [GONAL-F RFF]', 'Follitropin Alfa 900 IU/1.5 ML Subcutaneous Solution [GONAL-F RFF REDI-JECT]', 'FOLLITROPIN 900 [iU] in 1.5 mL SUBCUTANEOUS INJECTION, SOLUTION [Gonal-f RFF Redi-ject]', '0.75 ML Gonal F 600 UNT/ML Pen Injector', 'Gonal F 450 UNT per 0.75 ML Pen Injector', 'GONAL-f RFF Pen 450 UNT in 0.75 ML Pen Injector', 'Gonal F RFF Redi-ject 450 UNT per 0.75 ML Pen Injector', '0.75 ML follitropin alfa 600 UNT/ML Pen Injector [Gonal F]', 'Gonal-f RFF Pen, 450 intl units/0.75 mL subcutaneous solution', 'Gonal-f RFF Redi-ject Pen 450unit/0.75ml Solution for Injection', 'Follitropin Alfa 450 IU/0.75 ML Subcutaneous Solution [GONAL-F RFF]', 'Follitropin Alfa 450 IU/0.75 ML Subcutaneous Solution [GONAL-F RFF REDI-JECT]', 'FOLLITROPIN 450 [iU] in 0.75 mL SUBCUTANEOUS INJECTION, SOLUTION [Gonal-f RFF Redi-ject]', '0.5 ML Gonal F 600 UNT/ML Pen Injector', 'Gonal F RFF 300 UNT per 0.5 ML Pen Injector', 'GONAL-f RFF Pen 300 UNT in 0.5 ML Pen Injector', 'Gonal F RFF Redi-ject 300 UNT per 0.5 ML Pen Injector', '0.5 ML follitropin alfa 600 UNT/ML Pen Injector [Gonal F]', 'Gonal-f RFF Pen, alpha 300 intl units subcutaneous solution', 'Gonal-f RFF Redi-ject Pen 300unit/0.5ml Solution for Injection', 'Follitropin Alfa 300 IU/0.5 ML Subcutaneous Solution [GONAL-F RFF]', 'Follitropin Alfa 300 IU/0.5 ML Subcutaneous Solution [GONAL-F RFF REDI-JECT]', 'FOLLITROPIN 300 [iU] in 0.5 mL SUBCUTANEOUS INJECTION, SOLUTION [Gonal-f RFF Redi-ject]', 'follitropin alfa Pen Injector', 'FOLLITROPIN ALFA 300UNIT/0.5ML INJ PEN', 'FOLLITROPIN ALFA 300UNIT/0.5ML INJ,PEN,0.5ML', '0.5 ML follitropin alfa 600 UNT/ML Pen Injector', 'follitropin alfa 300 UNT in 0.5 ML Pen Injector', 'follitropin alfa 300 UNT per 0.5 ML Pen Injector', 'follitropin alfa, recombinant 300 unit/0.5 mL SUBCUT PEN INJECTOR (ML)', 'follitropin alfa, recombinant@300 unit/0.5 mL@SUBCUT@PEN INJECTOR (ML)', 'follitropin alfa Pen Injector [Gonal F]', 'FOLLITROPIN ALFA 450UNIT/0.75ML INJ PEN', 'FOLLITROPIN ALFA 450UNIT/0.75ML INJ,PEN,0.75ML', 'follitropin alfa 450 UNT in 0.75 ML Pen Injector', '0.75 ML follitropin alfa 600 UNT/ML Pen Injector', 'follitropin alfa 450 UNT per 0.75 ML Pen Injector', 'follitropin alfa, recombinant@450 unit/0.75 mL@SUBCUT@PEN INJECTOR (ML)', 'follitropin alfa, recombinant 450 unit/0.75 mL SUBCUT PEN INJECTOR (ML)', 'follicle stimulating hormone 450 intl units/0.75 mL subcutaneous solution', 'FOLLITROPIN ALFA 900UNT/1.5ML INJ PEN', 'FOLLITROPIN ALFA 900UNT/1.5ML INJ,PEN,1.5ML', '1.5 ML follitropin alfa 600 UNT/ML Pen Injector', 'follitropin alfa 900 UNT in 1.5 ML Pen Injector', 'follitropin alfa 900 UNT per 1.5 ML Pen Injector', 'follitropin alfa, recombinant@900 unit/1.5 mL@SUBCUT@PEN INJECTOR (ML)', 'follitropin alfa, recombinant 900 unit/1.5 mL SUBCUT PEN INJECTOR (ML)', 'follitropin beta Cartridge', 'follitropin beta Cartridge [Follistim]', 'follitropin alfa 75 UNT', 'follitropin alfa Injection', 'follitropin alfa 75 UNT [Gonal F]', 'follitropin alfa Injection [Gonal F]', 'follitropin beta Injection', 'follicle stimulating hormone 75 UNT', 'follicle stimulating hormone, porcine', 'Follicle Stimulating Hormone (Porcine)', 'FOLLICLE STIMULATING HORMONE (PORCINE)'], 'taxa': [], 'types': ['biolink:SmallMolecule', 'biolink:MolecularEntity', 'biolink:ChemicalEntity', 'biolink:PhysicalEssence', 'biolink:ChemicalOrDrugOrTreatment', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:ChemicalEntityOrProteinOrPolypeptide', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent', 'biolink:Drug', 'biolink:OntologyClass', 'biolink:MolecularMixture', 'biolink:ChemicalMixture'], 'score': 39.48553, 'clique_identifier_count': 148}]}
✅ Stage 3 perfect match results:
   FSH: 3 perfect matches
   DLK1: 1 perfect matches
PASSED
tests/test_stage3_text_matching.py::test_stage3_fsh_edge_text_matching --- STAGE 3 INPUT ---
edge: {'subject': 'GTOPDB:4386', 'object': 'NCBIGene:8788', 'sentences': 'FSH stimulation increased DLK1 protein expression levels significantly.'}
synonyms_data: {'GTOPDB:4386': {'curie': 'GTOPDB:4386', 'preferred_name': 'FSH', 'names': ['FSH', '4384', '4377'], 'types': ['SmallMolecule']}, 'NCBIGene:8788': {'curie': 'NCBIGene:8788', 'preferred_name': 'DLK1', 'names': ['DLK1', 'FA1', 'PREF1', 'fetal antigen 1', 'protein delta homolog 1'], 'types': ['Gene']}}
=== STAGE 3: Text Matching & Lookup ===
Finding synonyms in supporting text...
Found 2 synonyms in text: ['DLK1', 'FSH']...
Performing reverse lookups for found synonyms...
Text matching and lookup completed in 0.12 seconds
--- STAGE 3 OUTPUT ---
lookup_cache: {'DLK1': [{'curie': 'NCBIGene:8788', 'label': 'DLK1', 'highlighting': {}, 'synonyms': ['DLK', 'pG2', 'ZOG', 'FA1', 'DLK1', 'PREF1', 'DLK-1', 'Delta1', 'Pref-1', 'DLK1 Gene', 'DLK1 gene', 'secredeltin', 'FETAL ANTIGEN 1', 'fetal antigen 1', 'delta-like 1 homolog', 'PREADIPOCYTE FACTOR 1', 'preadipocyte factor 1', 'protein delta homolog 1', 'delta-like homolog (Drosophila)', 'delta-like 1 homolog (Drosophila)', 'DELTA, DROSOPHILA, HOMOLOG-LIKE 1', 'DELTA-LIKE NONCANONICAL NOTCH LIGAND 1', 'Delta-Like 1 Homolog (Drosophila) Gene', 'delta like non-canonical Notch ligand 1', 'FA1 protein, human', 'DLK1 protein, human', 'Dll1 protein, human', 'PREF1 protein, human', 'Pref-1 protein, human', 'hDLK1-A protein, human', 'fetal antigen-1, human', 'fetal antigen 1, human', 'secredeltin protein, human', 'delta-like 1 protein, human', 'preadipocyte factor 1, human', 'pre-adipocyte factor 1, human', 'A8K019_HUMAN Protein delta homolog 1 (trembl)', 'delta-like 1 homolog (Drosophila) protein, human', 'hDLK1', 'pG2 (human)', 'DLK-1 (human)', 'Protein Delta Homolog 1', 'protein delta homolog 1 (human)', 'DLK1_HUMAN Protein delta homolog 1 (sprot)'], 'taxa': ['NCBITaxon:9606'], 'types': ['biolink:Gene', 'biolink:GeneOrGeneProduct', 'biolink:GenomicEntity', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:PhysicalEssence', 'biolink:OntologyClass', 'biolink:BiologicalEntity', 'biolink:ThingWithTaxon', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent', 'biolink:MacromolecularMachineMixin', 'biolink:Protein', 'biolink:GeneProductMixin', 'biolink:Polypeptide', 'biolink:ChemicalEntityOrProteinOrPolypeptide'], 'score': 3335.8547, 'clique_identifier_count': 11}], 'FSH': [{'curie': 'GTOPDB:4386', 'label': 'FSH', 'highlighting': {}, 'synonyms': ['FSH', '4384', '4377'], 'taxa': [], 'types': ['biolink:SmallMolecule', 'biolink:MolecularEntity', 'biolink:ChemicalEntity', 'biolink:PhysicalEssence', 'biolink:ChemicalOrDrugOrTreatment', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:ChemicalEntityOrProteinOrPolypeptide', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent'], 'score': 1296.6653, 'clique_identifier_count': 1}, {'curie': 'GTOPDB:4387', 'label': 'FSH', 'highlighting': {}, 'synonyms': ['FSH', '4385', '4378'], 'taxa': [], 'types': ['biolink:SmallMolecule', 'biolink:MolecularEntity', 'biolink:ChemicalEntity', 'biolink:PhysicalEssence', 'biolink:ChemicalOrDrugOrTreatment', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:ChemicalEntityOrProteinOrPolypeptide', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent'], 'score': 1296.6653, 'clique_identifier_count': 1}, {'curie': 'CHEBI:81569', 'label': 'Follitropin', 'highlighting': {}, 'synonyms': ['FSH', '3731', '3733', 'fshs', 'FSH-a', 'FSH-b', 'Bravelle', 'Fertinex', 'Metrodin', 'FSH-beta', 'Follitrin', 'FSH alpha', 'rFSH-alpha', 'Follitropin', 'FOLLITROPIN', 'follitropin', 'Metrodin HP', 'MENOTROPINS', 'Neo fertinorm', 'UROFOLLITROPIN', 'Urofollitropin', 'FSH preparation', 'Urofollitrophin', 'Folitropina beta', 'Follitropin alfa', 'FOLLITROPIN ALFA', 'Follitropin beta', 'Folitropina alfa', 'Follitrophin beta', 'Urinary human FSH', 'Follitropin gamma', 'Follitrophin alfa', 'Follitropin human', 'Folitropina delta', 'Follitropin delta', 'Follitropin alpha', 'follitropin delta', 'follitropin (FSH)', 'Follitrophin alpha', 'Human FSH, urinary', 'Metrodin high purity', 'Follitropin alfa/beta', 'High purity, metrodin', 'FSH-Follicle stim horm', 'Follotropin recombinant', 'Follicle-stimulating hormone', 'follicle-stimulating hormone', 'follicle hormone stimulating', 'FOLLICLE STIMULATING HORMONE', 'Follicle-Stimulating Hormone', 'follicle stimulating hormone', 'Follicle stimulating hormone', 'Follicle Stimulating Hormone', 'follicle hormones stimulating', 'Follicular stimulating hormone', 'follicular stimulating hormone', 'follicular hormones stimulating', 'follicle stimulating fsh hormone', 'FSH - Follicle stimulating hormone', 'FSH (Follicle Stimulating Hormone)', 'Follicle Stimulating Hormone, Human', 'Pituitary follicle stimulating hormone', 'Follicle stimulating hormone preparation', 'Follicle stimulating hormone (FSH), pituitary', 'Pituitary follicle stimulating hormone (substance)', 'Recombinant human follicle stimulating hormone beta', 'Recombinant human follicle-stimulating hormone (r-HFSH)', 'Pituitary follicle stimulating hormone-containing product', 'Product containing pituitary follicle stimulating hormone (medicinal product)', '2-[({1-[19-amino-13-(butan-2-yl)-6,9,12,15,18-pentahydroxy-7-[(C-hydroxycarbonimidoyl)methyl]-10-(1-hydroxyethyl)-16-[(4-hydroxyphenyl)methyl]-1,2-dithia-5,8,11,14,17-pentaazacycloicosa-5,8,11,14,17-pentaene-4-carbonyl]pyrrolidin-2-yl}(hydroxy)methylidene)amino]-N-[(C-hydroxycarbonimidoyl)methyl]-4-methylpentanimidate', 'Gonal F', 'GONAL-F', 'gonal f', 'gonal-f', 'f gonal', 'Gonal-F', 'follitropin alfa 37.5 UNT/ML Injectable Solution', 'Follitropin alfa 37.5 unit/mL solution for injection', 'Product containing precisely follitropin alfa 37.5 unit/1 milliliter conventional release solution for injection (clinical drug)', 'GONAL-F RFF KIT', 'Gonal F 75 UNT Injection', 'Gonal-F 75iu inj pdr+diluent', 'GONAL-f RFF 75 UNT Injection', 'Gonal-f RFF 75unit Powder for Injection', 'follitropin alfa 75 UNT Injection [Gonal F]', 'Gonal-F 75iu injection (pdr for recon)+diluent', 'Follitropin Alfa 75 IU Subcutaneous Powder for Solution [GONAL-F]', 'Gonal-f RFF, alpha 75 intl units subcutaneous powder for injection', 'Follitropin Alfa 75 IU Subcutaneous Powder for Solution [GONAL-F RFF]', 'FOLLITROPIN 75 [iU] in 1 mL SUBCUTANEOUS INJECTION, POWDER, LYOPHILIZED, FOR SOLUTION [GONAL-F RFF]', 'Follitropin alpha 150iu inj', 'Recom human FSH alph 150iu inj', 'follitropin alfa 300 UNT/ML Injectable Solution', 'Follitropin alpha 150iu injection powder+diluent', 'Follitropin alfa 300 unit/mL solution for injection', 'Recomb human follicle stim horm alpha 150iu inj pdr+diluent', 'follicle stimulating hormone alpha 300 intl units subcutaneous solution', 'Recombinant human follicle stimulating hormone alpha 150iu injection (pdr for recon)+diluent', 'Product containing precisely follitropin alfa 300 unit/1 milliliter conventional release solution for injection (clinical drug)', 'Urofollitrophin 75iu inj+solv', 'urofollitropin 150 UNT/ML Injectable Solution', 'Urofollitropin 150 unit/mL solution for injection', 'Urofollitrophin 75iu injection (pdr for recon)+solvent', 'Product containing precisely urofollitropin 150 unit/1 milliliter conventional release solution for injection (clinical drug)', 'follicle stimulating hormone 150 UNT/ML', 'urofollitropin 150 UNT/ML', 'FOLLITROPIN ALFA 450 UNIT/VIL INJ', 'FOLLITROPIN ALFA 1050 UNIT/VIL INJ', 'follitropin alfa 600 UNT/ML Injectable Solution', 'Follitropin alfa 600 unit/mL solution for injection', 'Follitropin Alfa 900 IU/1.5 ML Subcutaneous Solution', 'Follitropin Alfa 450 IU/0.75 ML Subcutaneous Solution', 'follitropin alfa, recombinant 450 unit SUBCUT VIAL (EA)', 'follitropin alfa, recombinant@450 unit@SUBCUT@VIAL (EA)', 'follitropin alfa, recombinant@1,050 unit@SUBCUT@VIAL (EA)', 'follitropin alfa, recombinant 1,050 unit SUBCUT VIAL (EA)', 'follicle stimulating hormone alpha 900 intl units subcutaneous solution', 'follicle stimulating hormone alpha 450 intl units subcutaneous powder for injection', 'Product containing precisely follitropin alfa 600 unit/1 milliliter conventional release solution for injection (clinical drug)', 'Gonal-f KIT', 'Gonal-f 450unit Powder for Injection', 'Gonal-f 1050unit Powder for Injection', 'GONAL-f 600 UNT/ML Injectable Solution', 'Gonal F 600 UNT/ML Injectable Solution', 'follitropin alfa 600 UNT/ML Injectable Solution [Gonal F]', 'Gonal-F, 1050 intl units subcutaneous powder for injection', 'Gonal-F, alpha 450 intl units subcutaneous powder for injection', 'Follitropin Alfa 450 IU Subcutaneous Powder for Solution [GONAL-F]', 'Follitropin Alfa 1050 IU Subcutaneous Powder for Solution [GONAL-F]', 'FOLLITROPIN 450 [iU] in 1 mL SUBCUTANEOUS INJECTION, POWDER, LYOPHILIZED, FOR SOLUTION [Gonal-f]', 'FOLLITROPIN 1050 [iU] in 2 mL SUBCUTANEOUS INJECTION, POWDER, LYOPHILIZED, FOR SOLUTION [Gonal-f]', 'follitropin alfa Injectable Solution [Gonal F]', 'urofollitropin Injectable Solution', 'follitropin beta 150 UNT in 0.5 ML Injection', '0.5 ML follitropin beta 300 UNT/ML Injection', 'follitropin beta 150 UNT per 0.5 ML Injection', 'follicle stimulating hormone beta 300 intl units subcutaneous solution', 'follitropin beta 300 UNT/ML', 'follitropin beta 833 UNT/ML', 'follitropin alfa 37.5 UNT/ML', 'follitropin alfa 300 UNT/ML', 'follitropin alfa 600 UNT/ML', 'follitropin alfa Injectable Solution', 'follitropin beta 833 UNT/ML [Follistim]', 'Follitropin alpha 75iu inj', 'FOLLITROPIN ALFA 75UNT/VIL INJ', 'Recom human FSH alpha 75iu inj', 'follitropin alfa 75 UNT Injection', 'Follitropin alpha 75iu injection powder+diluent', 'follitropin alfa, recombinant 75 unit SUBCUT VIAL (EA)', 'follitropin alfa, recombinant@75 unit@SUBCUT@VIAL (EA)', 'Follitropin Alfa 75 IU Subcutaneous Powder for Solution', 'follitropin alfa, recombinant@75 unit@SUBCUT@AMPUL (EA)', 'follitropin alfa, recombinant 75 unit SUBCUT AMPUL (EA)', 'Recomb human follicle stim horm alpha 75iu inj pdr+diluent', 'Follitropin alfa 75 unit powder for solution for injection vial', 'follicle stimulating hormone alpha 75 intl units subcutaneous powder for injection', 'Recombinant human follicle stimulating hormone alpha 75iu injection (pdr for recon)+diluent', 'Product containing precisely follitropin alfa 75 unit/1 vial powder for conventional release solution for injection (clinical drug)', 'follitropin alfa 600 UNT/ML [Gonal F]', 'FOLLITROPIN BETA 300UNIT/0.36ML INJ', '0.36 ML follitropin beta 833 UNT/ML Cartridge', 'follitropin beta 300 UNT in 0.36 ML Cartridge', 'follitropin beta 300 IU per 0.36 ML Cartridge', 'follitropin beta,recomb 300 unit/0.36 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant 300 unit/0.36 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant@300 unit/0.36 mL@SUBCUT@CARTRIDGE (ML)', 'FOLLITROPIN BETA 600UNIT/0.72ML INJ', 'follitropin beta 600 IU per 0.72 ML Cartridge', '0.72 ML follitropin beta 833 UNT/ML Cartridge', 'follitropin beta 600 UNT in 0.72 ML Cartridge', 'follicle stimulating hormone beta 600 intl units subcutaneous solution', 'follitropin beta,recomb 600 unit/0.72 mL deliverable (833 unit/mL) SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant@600 unit/0.72 mL deliverable (833 unit/mL)@SUBCUT@CARTRIDGE (ML)', 'follitropin beta,recombinant 600 unit/0.72 mL deliverable (833 unit/mL) SUBCUT CARTRIDGE (ML)', 'FOLLITROPIN BETA 900UNIT/1.08ML INJ', '1.08 ML follitropin beta 833 UNT/ML Cartridge', 'follitropin beta 900 UNT in 1.08 ML Cartridge', 'follitropin beta 900 IU per 1.08 ML Cartridge', 'follitropin beta 900 UNT per 1.08 ML Cartridge', 'follitropin beta,recomb 900 unit/1.08 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant 900 unit/1.08 mL SUBCUT CARTRIDGE (ML)', 'follitropin beta,recombinant@900 unit/1.08 mL@SUBCUT@CARTRIDGE (ML)', 'follicle stimulating hormone beta 900 intl units subcutaneous solution', 'follicle stimulating hormone 52.5 UNT/ML', 'follicle stimulating hormone 35 UNT/ML', 'urofollitropin Injectable Product', 'Urofollitropin-containing product in parenteral dose form', 'Product containing urofollitropin in parenteral dose form (medicinal product form)', 'follitropin alfa Injectable Product', 'Follitropin alfa-containing product in parenteral dose form', 'Product containing follitropin alfa in parenteral dose form (medicinal product form)', 'follitropin beta Injectable Product', 'Gonal F Injectable Product', 'Follistim Injectable Product', '0.36 ML Follistim 833 UNT/ML Cartridge', 'Follistim AQ 300 IU per 0.36 ML Cartridge', 'Follistim AQ 300 UNT in 0.36 ML Cartridge', 'Follistim AQ 300units Cartridge Solution for Injection', '0.36 ML follitropin beta 833 UNT/ML Cartridge [Follistim]', 'Follistim AQ Cartridge, beta 300 intl units subcutaneous solution', 'Follitropin Beta 300 IU/0.36 ML Subcutaneous Solution [FOLLISTIM AQ]', 'follitropin 300 [iU] in 0.36 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', 'follitropin 350 [iU] in 0.42 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', '0.72 ML Follistim 833 UNT/ML Cartridge', 'Follistim AQ 600 UNT in 0.72 ML Cartridge', 'Follistim AQ 600 IU per 0.72 ML Cartridge', 'Follistim AQ 600units Cartridge Solution for Injection', '0.72 ML follitropin beta 833 UNT/ML Cartridge [Follistim]', 'Follistim AQ Cartridge, beta 600 intl units subcutaneous solution', 'Follitropin Beta 600 IU/0.72 ML Subcutaneous Solution [FOLLISTIM AQ]', 'follitropin 650 [iU] in 0.78 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', 'follitropin 600 [iU] in 0.72 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', '1.08 ML Follistim 833 UNT/ML Cartridge', 'Follistim AQ 900 UNT in 1.08 ML Cartridge', 'Follistim AQ 900 IU per 1.08 ML Cartridge', 'Follistim AQ 900units Cartridge Solution for Injection', '1.08 ML follitropin beta 833 UNT/ML Cartridge [Follistim]', 'Follistim AQ Cartridge, beta 900 intl units subcutaneous solution', 'Follitropin Beta 900 IU/1.08 ML Subcutaneous Solution [FOLLISTIM AQ]', 'follitropin 975 [iU] in 1.17 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', 'follitropin 900 [iU] in 1.08 mL SUBCUTANEOUS INJECTION, SOLUTION [Follistim AQ]', '1.5 ML Gonal F 600 UNT/ML Pen Injector', 'GONAL-f RFF Pen 900 UNT in 1.5 ML Pen Injector', 'Gonal F RFF Pen 900 UNT per 1.5 ML Pen Injector', 'Gonal F RFF Redi-ject 900 UNT per 1.5 ML Pen Injector', '1.5 ML follitropin alfa 600 UNT/ML Pen Injector [Gonal F]', 'Gonal-f RFF Pen, alpha 900 intl units subcutaneous solution', 'Gonal-f RFF Redi-ject Pen 900unit/1.5ml Solution for Injection', 'Follitropin Alfa 900 IU/1.5 ML Subcutaneous Solution [GONAL-F RFF]', 'Follitropin Alfa 900 IU/1.5 ML Subcutaneous Solution [GONAL-F RFF REDI-JECT]', 'FOLLITROPIN 900 [iU] in 1.5 mL SUBCUTANEOUS INJECTION, SOLUTION [Gonal-f RFF Redi-ject]', '0.75 ML Gonal F 600 UNT/ML Pen Injector', 'Gonal F 450 UNT per 0.75 ML Pen Injector', 'GONAL-f RFF Pen 450 UNT in 0.75 ML Pen Injector', 'Gonal F RFF Redi-ject 450 UNT per 0.75 ML Pen Injector', '0.75 ML follitropin alfa 600 UNT/ML Pen Injector [Gonal F]', 'Gonal-f RFF Pen, 450 intl units/0.75 mL subcutaneous solution', 'Gonal-f RFF Redi-ject Pen 450unit/0.75ml Solution for Injection', 'Follitropin Alfa 450 IU/0.75 ML Subcutaneous Solution [GONAL-F RFF]', 'Follitropin Alfa 450 IU/0.75 ML Subcutaneous Solution [GONAL-F RFF REDI-JECT]', 'FOLLITROPIN 450 [iU] in 0.75 mL SUBCUTANEOUS INJECTION, SOLUTION [Gonal-f RFF Redi-ject]', '0.5 ML Gonal F 600 UNT/ML Pen Injector', 'Gonal F RFF 300 UNT per 0.5 ML Pen Injector', 'GONAL-f RFF Pen 300 UNT in 0.5 ML Pen Injector', 'Gonal F RFF Redi-ject 300 UNT per 0.5 ML Pen Injector', '0.5 ML follitropin alfa 600 UNT/ML Pen Injector [Gonal F]', 'Gonal-f RFF Pen, alpha 300 intl units subcutaneous solution', 'Gonal-f RFF Redi-ject Pen 300unit/0.5ml Solution for Injection', 'Follitropin Alfa 300 IU/0.5 ML Subcutaneous Solution [GONAL-F RFF]', 'Follitropin Alfa 300 IU/0.5 ML Subcutaneous Solution [GONAL-F RFF REDI-JECT]', 'FOLLITROPIN 300 [iU] in 0.5 mL SUBCUTANEOUS INJECTION, SOLUTION [Gonal-f RFF Redi-ject]', 'follitropin alfa Pen Injector', 'FOLLITROPIN ALFA 300UNIT/0.5ML INJ PEN', 'FOLLITROPIN ALFA 300UNIT/0.5ML INJ,PEN,0.5ML', '0.5 ML follitropin alfa 600 UNT/ML Pen Injector', 'follitropin alfa 300 UNT in 0.5 ML Pen Injector', 'follitropin alfa 300 UNT per 0.5 ML Pen Injector', 'follitropin alfa, recombinant 300 unit/0.5 mL SUBCUT PEN INJECTOR (ML)', 'follitropin alfa, recombinant@300 unit/0.5 mL@SUBCUT@PEN INJECTOR (ML)', 'follitropin alfa Pen Injector [Gonal F]', 'FOLLITROPIN ALFA 450UNIT/0.75ML INJ PEN', 'FOLLITROPIN ALFA 450UNIT/0.75ML INJ,PEN,0.75ML', 'follitropin alfa 450 UNT in 0.75 ML Pen Injector', '0.75 ML follitropin alfa 600 UNT/ML Pen Injector', 'follitropin alfa 450 UNT per 0.75 ML Pen Injector', 'follitropin alfa, recombinant@450 unit/0.75 mL@SUBCUT@PEN INJECTOR (ML)', 'follitropin alfa, recombinant 450 unit/0.75 mL SUBCUT PEN INJECTOR (ML)', 'follicle stimulating hormone 450 intl units/0.75 mL subcutaneous solution', 'FOLLITROPIN ALFA 900UNT/1.5ML INJ PEN', 'FOLLITROPIN ALFA 900UNT/1.5ML INJ,PEN,1.5ML', '1.5 ML follitropin alfa 600 UNT/ML Pen Injector', 'follitropin alfa 900 UNT in 1.5 ML Pen Injector', 'follitropin alfa 900 UNT per 1.5 ML Pen Injector', 'follitropin alfa, recombinant@900 unit/1.5 mL@SUBCUT@PEN INJECTOR (ML)', 'follitropin alfa, recombinant 900 unit/1.5 mL SUBCUT PEN INJECTOR (ML)', 'follitropin beta Cartridge', 'follitropin beta Cartridge [Follistim]', 'follitropin alfa 75 UNT', 'follitropin alfa Injection', 'follitropin alfa 75 UNT [Gonal F]', 'follitropin alfa Injection [Gonal F]', 'follitropin beta Injection', 'follicle stimulating hormone 75 UNT', 'follicle stimulating hormone, porcine', 'Follicle Stimulating Hormone (Porcine)', 'FOLLICLE STIMULATING HORMONE (PORCINE)'], 'taxa': [], 'types': ['biolink:SmallMolecule', 'biolink:MolecularEntity', 'biolink:ChemicalEntity', 'biolink:PhysicalEssence', 'biolink:ChemicalOrDrugOrTreatment', 'biolink:ChemicalEntityOrGeneOrGeneProduct', 'biolink:ChemicalEntityOrProteinOrPolypeptide', 'biolink:NamedThing', 'biolink:Entity', 'biolink:PhysicalEssenceOrOccurrent', 'biolink:Drug', 'biolink:OntologyClass', 'biolink:MolecularMixture', 'biolink:ChemicalMixture'], 'score': 39.48553, 'clique_identifier_count': 148}]}
✅ Stage 3 text matching and lookup results:
   Found synonyms: ['DLK1', 'FSH']
   'DLK1' -> 1 lookup results
   'FSH' -> 3 lookup results
PASSED
tests/test_stage4_classification.py::test_stage4_fsh_edge_classification --- STAGE 4 INPUT ---
edge: {'subject': 'GTOPDB:4386', 'object': 'NCBIGene:8788', 'sentences': 'FSH stimulation increased DLK1 protein expression levels significantly.'}
lookup_cache: {'FSH': [{'curie': 'CHEBI:81569', 'label': 'FSH', 'synonyms': ['FSH', 'follicle-stimulating hormone'], 'types': ['SmallMolecule']}, {'curie': 'GTOPDB:4386', 'label': 'FSH', 'synonyms': ['FSH', '4384', '4377'], 'types': ['SmallMolecule']}, {'curie': 'GTOPDB:4387', 'label': 'FSH', 'synonyms': ['FSH', 'follicle stimulating hormone'], 'types': ['SmallMolecule']}], 'DLK1': [{'curie': 'NCBIGene:8788', 'label': 'DLK1', 'synonyms': ['DLK1', 'FA1', 'PREF1', 'fetal antigen 1', 'protein delta homolog 1'], 'types': ['Gene'], 'taxa': ['NCBITaxon:9606']}]}
normalized_data: {'GTOPDB:4386': {'id': {'identifier': 'GTOPDB:4386', 'label': 'FSH'}, 'equivalent_identifiers': [{'identifier': 'GTOPDB:4386', 'label': 'FSH'}, {'identifier': 'CHEBI:81569', 'label': 'follicle-stimulating hormone'}], 'type': ['biolink:SmallMolecule']}, 'NCBIGene:8788': {'id': {'identifier': 'NCBIGene:8788', 'label': 'DLK1'}, 'equivalent_identifiers': [{'identifier': 'NCBIGene:8788', 'label': 'DLK1'}], 'type': ['biolink:Gene']}}
synonyms_data: {'GTOPDB:4386': {'curie': 'GTOPDB:4386', 'preferred_name': 'FSH', 'names': ['FSH', '4384', '4377'], 'types': ['SmallMolecule']}, 'NCBIGene:8788': {'curie': 'NCBIGene:8788', 'preferred_name': 'DLK1', 'names': ['DLK1', 'FA1', 'PREF1', 'fetal antigen 1', 'protein delta homolog 1'], 'types': ['Gene']}}
--- STAGE 4 OUTPUT ---
result: ('ambiguous', {'subject_curie': 'GTOPDB:4386', 'object_curie': 'NCBIGene:8788', 'edge_text': 'FSH stimulation increased DLK1 protein expression levels significantly.', 'subject_synonyms_found': ['FSH'], 'subject_ambiguous': True, 'subject_lookup_data': {'FSH': [{'curie': 'CHEBI:81569', 'label': 'FSH', 'taxa': [], 'score': 0, 'synonyms': ['FSH', 'follicle-stimulating hormone'], 'types': ['SmallMolecule']}, {'curie': 'GTOPDB:4386', 'label': 'FSH', 'taxa': [], 'score': 0, 'synonyms': ['FSH', '4384', '4377'], 'types': ['SmallMolecule']}, {'curie': 'GTOPDB:4387', 'label': 'FSH', 'taxa': [], 'score': 0, 'synonyms': ['FSH', 'follicle stimulating hormone'], 'types': ['SmallMolecule']}]}, 'object_synonyms_found': ['DLK1'], 'object_ambiguous': False, 'object_lookup_data': {'DLK1': [{'curie': 'NCBIGene:8788', 'label': 'DLK1', 'taxa': ['NCBITaxon:9606'], 'score': 0, 'synonyms': ['DLK1', 'FA1', 'PREF1', 'fetal antigen 1', 'protein delta homolog 1'], 'types': ['Gene']}]}, 'reason': 'Ambiguous entity matches found'})
✅ Stage 4 classification result: ambiguous
   Debug info: {'subject_curie': 'GTOPDB:4386', 'object_curie': 'NCBIGene:8788', 'edge_text': 'FSH stimulation increased DLK1 protein expression levels significantly.', 'subject_synonyms_found': ['FSH'], 'subject_ambiguous': True, 'subject_lookup_data': {'FSH': [{'curie': 'CHEBI:81569', 'label': 'FSH', 'taxa': [], 'score': 0, 'synonyms': ['FSH', 'follicle-stimulating hormone'], 'types': ['SmallMolecule']}, {'curie': 'GTOPDB:4386', 'label': 'FSH', 'taxa': [], 'score': 0, 'synonyms': ['FSH', '4384', '4377'], 'types': ['SmallMolecule']}, {'curie': 'GTOPDB:4387', 'label': 'FSH', 'taxa': [], 'score': 0, 'synonyms': ['FSH', 'follicle stimulating hormone'], 'types': ['SmallMolecule']}]}, 'object_synonyms_found': ['DLK1'], 'object_ambiguous': False, 'object_lookup_data': {'DLK1': [{'curie': 'NCBIGene:8788', 'label': 'DLK1', 'taxa': ['NCBITaxon:9606'], 'score': 0, 'synonyms': ['DLK1', 'FA1', 'PREF1', 'fetal antigen 1', 'protein delta homolog 1'], 'types': ['Gene']}]}, 'reason': 'Ambiguous entity matches found'}
PASSED

=============================== warnings summary ===============================
tests/test_integration.py:162
  /Users/bizon/Projects/experiments/TMKP_QC_2/tests/test_integration.py:162: PytestUnknownMarkWarning: Unknown pytest.mark.slow - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.slow

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================= 5 passed, 21 deselected, 1 warning in 0.41s ==================
